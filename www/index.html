<!DOCTYPE html>
<!--[if IE 8]> <html lang="en" class="ie8 no-js"> <![endif]-->
<!--[if IE 9]> <html lang="en" class="ie9 no-js"> <![endif]-->
<!--[if !IE]><!-->
<html lang="en" class="no-js">
<!--<![endif]-->
<!-- BEGIN HEAD -->
<head>
    <meta charset="utf-8" />
    <title>MoCA</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta content="width=device-width, initial-scale=1.0,user-scalable=no" name="viewport" />
    <meta name="apple-mobile-web-app-capable" content="yes">
     
    <meta content="" name="description" />
    <meta content="" name="author" />
    <!--<meta name="MobileOptimized" content="320">-->
    <!-- BEGIN GLOBAL MANDATORY STYLES -->
    <link href="assets/plugins/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css" />
    <link href="assets/plugins/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
    <link href="assets/plugins/uniform/css/uniform.default.css" rel="stylesheet" type="text/css" />
    <!-- END GLOBAL MANDATORY STYLES -->
    <!-- BEGIN PAGE LEVEL STYLES -->
    <link rel="stylesheet" type="text/css" href="assets/plugins/bootstrap-fileupload/bootstrap-fileupload.css" />
    <link rel="stylesheet" type="text/css" href="assets/plugins/gritter/css/jquery.gritter.css" />
    <link rel="stylesheet" type="text/css" href="assets/plugins/select2/select2_metro.css" />
    <link rel="stylesheet" type="text/css" href="assets/plugins/clockface/css/clockface.css" />
    <link rel="stylesheet" type="text/css" href="assets/plugins/bootstrap-wysihtml5/bootstrap-wysihtml5.css" />
    <link rel="stylesheet" type="text/css" href="assets/plugins/bootstrap-datepicker/css/datepicker.css" />
    <link rel="stylesheet" type="text/css" href="assets/plugins/bootstrap-timepicker/compiled/timepicker.css" />
    <link rel="stylesheet" type="text/css" href="assets/plugins/bootstrap-colorpicker/css/colorpicker.css" />
    <link rel="stylesheet" type="text/css" href="assets/plugins/bootstrap-daterangepicker/daterangepicker-bs3.css" />
    <link rel="stylesheet" type="text/css" href="assets/plugins/bootstrap-datetimepicker/css/datetimepicker.css" />
    <link rel="stylesheet" type="text/css" href="assets/plugins/jquery-multi-select/css/multi-select.css" />
    <link rel="stylesheet" type="text/css" href="assets/plugins/bootstrap-switch/static/stylesheets/bootstrap-switch-metro.css" />
    <link rel="stylesheet" type="text/css" href="assets/plugins/jquery-tags-input/jquery.tagsinput.css" />
    <link rel="stylesheet" type="text/css" href="assets/plugins/bootstrap-markdown/css/bootstrap-markdown.min.css">
    <link rel="stylesheet" type="text/css" href="assets/plugins/bootstrap-toastr/toastr.min.css" />
    <!-- END PAGE LEVEL STYLES -->
    <!-- BEGIN THEME STYLES -->
    <link href="assets/css/style-metronic.css" rel="stylesheet" type="text/css" />
    <link href="assets/css/style.css" rel="stylesheet" type="text/css" />
    <link href="assets/css/style-responsive.css" rel="stylesheet" type="text/css" />
    <link href="assets/css/plugins.css" rel="stylesheet" type="text/css" />
    <link href="assets/css/themes/default.css" rel="stylesheet" type="text/css" id="style_color" />
    <link href="assets/css/custom.css" rel="stylesheet" type="text/css" />
    <link href="assets/css/pages/login.css" rel="stylesheet" type="text/css" />
    <!-- END THEME STYLES -->
    <!-- BEGIN BOXWELL STYLE -->
    <link href="assets/css/boxwell.css" rel="stylesheet" type="text/css" />
    <!-- END BOXWELL STYLE -->
    <link rel="shortcut icon" href="../favicon.ico" />
    <script src="assets/scripts/site.manage.js"></script>
    
</head>
<!-- BEGIN BODY -->
<body class="login">
    <div class="header navbar navbar-inverse ">
        <div class="header-inner">
            <a href="index.html" class="navbar-brand">
                <span style="padding-left: 10px;">e-MoCA version 8.1</span>
            </a>
        </div>
    </div>
    <div class="content">
        <div class="login-form">
            <h3 class="form-title">Administered by</h3>
            <div class="alert alert-error hide">
                <button class="close" data-dismiss="alert"></button>
                <span>Enter your name and your occupation.</span>
            </div>
            SELECT AN EXISTING ADMINISTRATOR
            <div class="form-group">
                <!--ie8, ie9 does not support html5 placeholder, so we just show field title for that-->
                <label class="control-label visible-ie8 visible-ie9">Name</label>
                <div class="input-icon">
                    <i class="icon-user"></i>
                    <select id="ddlAdministrators" class="form-control"></select>
                </div>
            </div>
            <div class="form-actions">

                <button id="btnSubmitDll" type="submit" class="btn purple pull-right" runat="server">
                    <i class="icon-arrow-right"></i> Continue</i>
                </button>
            </div>
            <h3>OR</h3>
            CREATE A NEW ADMINISTRATOR
            <div class="form-group">
                <!--ie8, ie9 does not support html5 placeholder, so we just show field title for that-->
                <label class="control-label visible-ie8 visible-ie9">Name</label>
                <div class="input-icon">
                    <i class="icon-user-md"></i>
                    <input id="txtName" class="form-control placeholder-no-fix" type="text" autocomplete="off" placeholder="Name" name="name" runat="server" />
                </div>
            </div>
            <div class="form-group">
                <label class="control-label visible-ie8 visible-ie9">Occupation</label>
                <div class="input-icon">
                    <i class="icon-stethoscope"></i>
                    <input id="txtOccupation" class="form-control placeholder-no-fix" type="text" autocomplete="off" placeholder="Occupation" name="occupation" runat="server" />
                </div>
            </div>
            <div class="form-actions">
                <button id="btnSubmit" type="submit" class="btn purple pull-right" runat="server">
                    <i class="icon-arrow-right"></i> Continue</i>
                </button>
                <!--<i class="icon-arrow-right"> Continue</i>-->
        
            </div>
            <div class="row-fluid" style="margin-top: 20px;text-align: right;">
                <button type="button" class="btn blue" id="btnContinue" onclick="window.location = 'testList.html';return false;">
                    <i class="icon-arrow-right"></i>
                    Show test results
                </button>
            </div>
        </div>
    </div>
    
    <div class="copyright">
        e-MoCA &copy; Copyright 2014.
    </div>

    <script src="assets/plugins/jquery-1.10.2.min.js" type="text/javascript"></script>
    <script src="assets/plugins/bootstrap/js/bootstrap.min.js" type="text/javascript"></script>
    <script src="assets/plugins/jquery.cookie.min.js" type="text/javascript"></script>
    <script type="text/javascript" src="assets/plugins/fuelux/js/spinner.min.js"></script>
    <script type="text/javascript" src="assets/plugins/select2/select2.min.js"></script>
    <script type="text/javascript" src="assets/plugins/bootstrap-datetimepicker/js/bootstrap-datetimepicker.js"></script>
    <script type="text/javascript" src="assets/plugins/jquery-inputmask/jquery.inputmask.bundle.min.js"></script>
    <script type="text/javascript" src="assets/plugins/jquery.input-ip-address-control-1.0.min.js"></script>
    <script type="text/javascript" src="assets/plugins/jquery-multi-select/js/jquery.multi-select.js"></script>
    <script src="assets/plugins/bootstrap-maxlength/bootstrap-maxlength.min.js" type="text/javascript"></script>
    <script src="assets/plugins/bootstrap-toastr/toastr.min.js"></script>
    <script src="assets/scripts/jquery.session.js"></script>
    <script src="assets/scripts/ui-toastr.js"></script>
    <script src="assets/scripts/app.js"></script>
    <script src="assets/scripts/form-components.js"></script>
    <script src="assets/scripts/jquery.numeric.js"></script>
    <script src="assets/scripts/phonegap-1.1.0.js"></script>
    <script src="assets/scripts/db.manager.js"></script>
    <script src="assets/scripts/jquery.bpopup.min.js"></script>
    <script>
    
        $(document).ready(function () {
           
            DB.setupTable(function (dataRes) {
             
                DB.selectData('SELECT * FROM MocaTestUsers', function (data) {
    
                    for (var i = 0; i < data.rows.length; i++) {
                        var v = data.rows.item(i);
                       
                        var option = $('<option>', {
                            text: v.name + ' | ' + v.occupation,
                            value: v.userID
                        });
                        $('#ddlAdministrators').append(option);
                    };
                    $('#ddlAdministrators').select2({
                        placeholder: "Select",
                        allowClear: true
                    });
                });
            });

        });

    </script>
    <script>


        $("#btnSubmit").click(function () {
            
            var name = $("#txtName").val();
            var occupation = $("#txtOccupation").val();
            if(occupation && name){
                var user =
                {
                    tableName: 'MocaTestUsers',
                    data: [{
                        "name": name,
                        "occupation": occupation
                    }]
                };
                DB.insertData(user, function (data) {
                    $.session.set('userId', data.insertId);
                     window.location = "createClient.html";
                });
            }else {
                var text = '';
                if(!name){
                    text = 'The field "Name" is required';
                    $('#txtName').closest('.input-icon').css({'border':'1px solid red'});
                    if(!$('#txtName').closest('.input-icon').next().hasClass('pError')){
                        $('#txtName').closest('.input-icon').after('<p style="color:red;margin-top: 5px;" class="pError">'+text+'</p>');
                    }
                }else {
                    $('#txtName').closest('.input-icon').css({'border':'none'}).nextAll('.pError').remove();
                }
                if(!occupation){
                    text = 'The field "Occupation" is required';
                    $('#txtOccupation').closest('.input-icon').css({'border':'1px solid red'});
                    if(!$('#txtOccupation').closest('.input-icon').next().hasClass('pError')){
                        $('#txtOccupation').closest('.input-icon').after('<p style="color:red;margin-top: 5px;" class="pError">'+text+'</p>');
                    }
                }else {
                    $('#txtOccupation').closest('.input-icon').css({'border':'none'}).nextAll('.pError').remove();
                }
            }
            return false;
        });
        $("#btnSubmitDll").click(function () {
            if($("#ddlAdministrators").val()){
                var occupation = $("#ddlAdministrators").val();
                $.session.set('userId', occupation);
                window.location = "createClient.html";
                return false;
            }else {
                $('#SendMail').bPopup();
            }
        });


        jQuery(document).ready(function () {
            
            App.init();
            UIToastr.init();
            FormComponents.init();
            $.session.clear();
 
        });
    </script>
    
    <div class="content" id="SendMail" style="display: none; width: 500px !important;">
        <div class="login-form">
            <h3 class="form-title" id="infoText" style="font-size: 20px;text-align: center;">Pleace create a new administrator!</h3>
            <div class="alert alert-error hide">
                <button class="close" data-dismiss="alert"></button>
                <span></span>
            </div>
            <div class="form-actions">
                <button id="" onclick="$('#SendMail').bPopup().close();" type="submit" class="bCloce btn purple pull-right" style="margin-right: 10px;">
                    <i class="icon-cancel"></i> OK
                </button>
            </div>
        </div>
    </div>
</body>
<!-- END BODY -->
</html>
